#' @export
define_chip_vtracks <- function() {
    gvtrack.create("e10_limb_k4me1", "ENCODE.bing_ren.e10_5.limb.h3k4me1_sum", "global.percentile")
    gvtrack.create("e10_heart_k4me1", "ENCODE.bing_ren.e10_5.heart.h3k4me1_sum", "global.percentile")
    gvtrack.create("e10_fc_k4me1", "ENCODE.bing_ren.e10_5.embryonic_facial_prominence.h3k4me1_sum", "global.percentile")
    gvtrack.create("e10_midbrain_k4me1", "ENCODE.bing_ren.e10_5.midbrain.h3k4me1_sum", "global.percentile")
    gvtrack.create("e10_hindbrain_k4me1", "ENCODE.bing_ren.e10_5.hindbrain.h3k4me1_sum", "global.percentile")
    gvtrack.create("e10_forebrain_k4me1", "ENCODE.bing_ren.e10_5.forebrain.h3k4me1_sum", "global.percentile")
    gvtrack.create("e11_liver_k4me1", "ENCODE.bing_ren.e11_5.liver.h3k4me1_sum", "global.percentile")
    gvtrack.create("e14_stomach_k4me1", "ENCODE.bing_ren.e14_5.stomach.h3k4me1_sum", "global.percentile")
    gvtrack.create("e14_kidney_k4me1", "ENCODE.bing_ren.e14_5.kidney.h3k4me1_sum", "global.percentile")

    gvtrack.create("e10_limb_k27ac", "ENCODE.bing_ren.e10_5.limb.h3k27ac_dense", "global.percentile")
    gvtrack.create("e10_heart_k27ac", "ENCODE.bing_ren.e10_5.heart.h3k27ac_dense", "global.percentile")
    gvtrack.create("e10_midbrain_k27ac", "ENCODE.bing_ren.e10_5.midbrain.h3k27ac_dense", "global.percentile")
    gvtrack.create("e10_hindbrain_k27ac", "ENCODE.bing_ren.e10_5.hindbrain.h3k27ac_dense", "global.percentile")
    gvtrack.create("e10_forebrain_k27ac", "ENCODE.bing_ren.e10_5.forebrain.h3k27ac_dense", "global.percentile")

    gvtrack.create("es_k4me3", "Encode.esb4.h3k4me3.rep1", "global.percentile")
    gvtrack.create("e10_limb_k4me3", "ENCODE.bing_ren.e10_5.limb.h3k4me3_sum", "global.percentile")
    gvtrack.create("e10_heart_k4me3", "ENCODE.bing_ren.e10_5.heart.h3k4me3_sum", "global.percentile")
    gvtrack.create("e10_midbrain_k4me3", "ENCODE.bing_ren.e10_5.midbrain.h3k4me3_sum", "global.percentile")
    gvtrack.create("e10_hindbrain_k4me3", "ENCODE.bing_ren.e10_5.hindbrain.h3k4me3_sum", "global.percentile")
    gvtrack.create("e10_forebrain_k4me3", "ENCODE.bing_ren.e10_5.forebrain.h3k4me3_sum", "global.percentile")

    gvtrack.create("e11_limb_k4me1", "ENCODE.bing_ren.e11_5.limb.h3k4me1_rep1_1", "global.percentile")
    gvtrack.create("e11_heart_k4me1", "ENCODE.bing_ren.e11_5.heart.h3k4me1_rep1", "global.percentile")
    gvtrack.create("e11_midbrain_k4me1", "ENCODE.bing_ren.e11_5.midbrain.h3k4me1_rep1", "global.percentile")
    gvtrack.create("e11_hindbrain_k4me1", "ENCODE.bing_ren.e11_5.hindbrain.h3k4me1_rep1_1", "global.percentile")
    gvtrack.create("e11_forebrain_k4me1", "ENCODE.bing_ren.e11_5.forebrain.h3k4me1_rep1_1", "global.percentile")
    gvtrack.create("e11_liver_k4me1", "ENCODE.bing_ren.e11_5.liver.h3k4me1_rep1_1", "global.percentile")

    gvtrack.create("e11_limb_k4me3", "ENCODE.bing_ren.e11_5.limb.h3k4me3_rep1", "global.percentile")
    gvtrack.create("e11_heart_k4me3", "ENCODE.bing_ren.e11_5.heart.h3k4me3_rep1", "global.percentile")
    gvtrack.create("e11_midbrain_k4me3", "ENCODE.bing_ren.e11_5.midbrain.h3k4me3_rep1", "global.percentile")
    gvtrack.create("e11_hindbrain_k4me3", "ENCODE.bing_ren.e11_5.hindbrain.h3k4me3_rep1", "global.percentile")
    gvtrack.create("e11_forebrain_k4me3", "ENCODE.bing_ren.e11_5.forebrain.h3k4me3_rep1", "global.percentile")
    gvtrack.create("e11_liver_k4me3", "ENCODE.bing_ren.e11_5.liver.h3k4me3_rep1", "global.percentile")

    gvtrack.create("e10_fc_k27me3", "ENCODE.bing_ren.e10_5.embryonic_facial_prominence.h3k27me3_sum", "global.percentile")
    gvtrack.create("e10_forebrain_k27me3", "ENCODE.bing_ren.e10_5.forebrain.h3k27me3_sum", "global.percentile")
    gvtrack.create("e10_heart_k27me3", "ENCODE.bing_ren.e10_5.heart.h3k27me3_sum", "global.percentile")
    gvtrack.create("e10_hindbrain_k27me3", "ENCODE.bing_ren.e10_5.hindbrain.h3k27me3_sum", "global.percentile")
    gvtrack.create("e10_limb_k27me3", "ENCODE.bing_ren.e10_5.limb.h3k27me3_sum", "global.percentile")
    gvtrack.create("e10_midbrain_k27me3", "ENCODE.bing_ren.e10_5.midbrain.h3k27me3_sum", "global.percentile")
    gvtrack.create("es_k27me3", "Encode.esb4.h3k27me3.rep1", "global.percentile")

    gvtrack.create("e11_forebrain_k27me3", "ENCODE.bing_ren.e11_5.forebrain.h3k27me3_rep1_1", "global.percentile")
    gvtrack.create("e11_heart_k27me3", "ENCODE.bing_ren.e11_5.heart.h3k27me3_rep1_1", "global.percentile")
    gvtrack.create("e11_hindbrain_k27me3", "ENCODE.bing_ren.e11_5.hindbrain.h3k27me3_rep1_1", "global.percentile")
    gvtrack.create("e11_limb_k27me3", "ENCODE.bing_ren.e11_5.limb.h3k27me3_rep1_1", "global.percentile")
    gvtrack.create("e11_midbrain_k27me3", "ENCODE.bing_ren.e11_5.midbrain.h3k27me3_rep1_1", "global.percentile")


    gvtrack.create("ecto_k27ac", "Xiang_Nature_Genetics_2019.Ect_H3K27ac", "global.percentile")
    gvtrack.create("ecto_k27me3", "Xiang_Nature_Genetics_2019.Ect_H3K27me3", "global.percentile")
    gvtrack.create("ecto_k4me3", "Xiang_Nature_Genetics_2019.Ect_H3K4me3", "global.percentile")
    gvtrack.create("ecto_atac", "Xiang_Nature_Genetics_2019.Ect_ATAC", "global.percentile")

    gvtrack.create("endo_k27ac", "Xiang_Nature_Genetics_2019.End_H3K27ac", "global.percentile")
    gvtrack.create("endo_k27me3", "Xiang_Nature_Genetics_2019.End_H3K27me3", "global.percentile")
    gvtrack.create("endo_k4me3", "Xiang_Nature_Genetics_2019.End_H3K4me3", "global.percentile")
    gvtrack.create("endo_atac", "Xiang_Nature_Genetics_2019.End_ATAC", "global.percentile")

    gvtrack.create("meso_k27ac", "Xiang_Nature_Genetics_2019.Mes_H3K27ac", "global.percentile")
    gvtrack.create("meso_k27me3", "Xiang_Nature_Genetics_2019.Mes_H3K27me3", "global.percentile")
    gvtrack.create("meso_k4me3", "Xiang_Nature_Genetics_2019.Mes_H3K4me3", "global.percentile")
    gvtrack.create("meso_atac", "Xiang_Nature_Genetics_2019.Mes_ATAC", "global.percentile")

    gvtrack.create("ps_k27ac", "Xiang_Nature_Genetics_2019.PS_H3K27ac", "global.percentile")
    gvtrack.create("ps_k27me3", "Xiang_Nature_Genetics_2019.PS_H3K27me3", "global.percentile")
    gvtrack.create("ps_k4me3", "Xiang_Nature_Genetics_2019.PS_H3K4me3", "global.percentile")
    gvtrack.create("ps_atac", "Xiang_Nature_Genetics_2019.PS_ATAC", "global.percentile")

    gvtrack.create("e6_epi_k27ac", "Xiang_Nature_Genetics_2019.E65Epi_H3K27ac", "global.percentile")
    gvtrack.create("e6_epi_k27me3", "Xiang_Nature_Genetics_2019.E65Epi_H3K27me3", "global.percentile")
    gvtrack.create("e6_epi_k4me3", "Xiang_Nature_Genetics_2019.E65Epi_H3K4me3", "global.percentile")

    gvtrack.create("e5_epi_k27me3", "Xiang_Nature_Genetics_2019.E55Epi_H3K27me3", "global.percentile")
    gvtrack.create("e5_epi_k4me3", "Xiang_Nature_Genetics_2019.E55Epi_H3K4me3", "global.percentile")

    gvtrack.create("e6_ve_k27ac", "Xiang_Nature_Genetics_2019.E65VE_H3K27ac", "global.percentile")
    gvtrack.create("e6_ve_k27me3", "Xiang_Nature_Genetics_2019.E65VE_H3K27me3", "global.percentile")
    gvtrack.create("e6_ve_k4me3", "Xiang_Nature_Genetics_2019.E65VE_H3K4me3", "global.percentile")
    gvtrack.create("e6_ve_atac", "Xiang_Nature_Genetics_2019.E65VE_ATAC", "global.percentile")
}

define_k27me3_peaks <- function() {
    define_chip_vtracks()

    hits <- gscreen("-log2(1-ecto_k27me3)>7 | -log2(1-endo_k27me3)>7 | -log2(1-meso_k27me3)>7 | -log2(1-ps_k27me3)>7 | -log2(1-e6_epi_k27me3)>7 | -log2(1-e5_epi_k27me3)>7 | -log2(1-e6_ve_k27me3)>7 | -log2(1-e10_fc_k27me3)>7 | -log2(1-e10_forebrain_k27me3)>7 | -log2(1-e10_heart_k27me3)>7 | -log2(1-e10_hindbrain_k27me3)>7 | -log2(1-e10_limb_k27me3)>7 | -log2(1-e10_midbrain_k27me3)>7 | -log2(1-es_k27me3)>7", iterator = 20)
    return(as_tibble(hits))
}

define_k4me3_peaks <- function() {
    define_chip_vtracks()

    hits <- gscreen("-log2(1-e10_limb_k4me3)>7 | -log2(1-e10_heart_k4me3)>7 | -log2(1-e10_midbrain_k4me3)>7 | -log2(1-e10_hindbrain_k4me3)>7 | -log2(1-e10_forebrain_k4me3)>7 | -log2(1-e11_liver_k4me3)>7 | -log2(1-ecto_k4me3)>7 | -log2(1-endo_k4me3)>7 | -log2(1-meso_k4me3)>7 | -log2(1-ps_k4me3)>7 | -log2(1-e6_epi_k4me3)>7 | -log2(1-e5_epi_k4me3)>7 | -log2(1-e6_ve_k4me3)>7")
    return(as_tibble(hits))
}

define_atac_peaks <- function() {
    define_chip_vtracks()

    hits <- gscreen("-log2(1-ecto_atac)>7 | -log2(1-endo_atac)>7 | -log2(1-meso_atac)>7 |  -log2(1-ps_atac)>7 |  -log2(1-e6_ve_atac)>7")

    gl <- c("ecto", "endo", "meso", "ps", "e6_ve")
    tracks <- glue("-log2(1-{gl}_atac)")
    expr <- paste(glue("{tracks}>7"), collapse = " | ")

    hits <- gscreen(expr)

    enh <- gextract(tracks, colnames = glue("{gl}_atac"), iterator = hits, intervals = hits) %>%
        arrange(intervalID) %>%
        select(-intervalID)
    return(as_tibble(enh))
}
